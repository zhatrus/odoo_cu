# **5.3. Змінні, вирази і атрибути**

- Змінні  
- Вирази  
- Атрибути

### **Змінні**

**QWeb** дозволяє створювати змінні всередині шаблону, запам’ятовувати обчислення (використовувати його кілька разів, модифікувати інше…), дати фрагменту даних більш чітке ім’я.

Це робиться за допомогою set директиви, яка приймає ім’я створюваної змінної. Встановлене значення можна надати двома способами:

атрибут , t-value що містить вираз, і в змінну буде записаний результат його оцінки:

\<t t-set="foo" t-value="2 \+ 1"/\>

\<t t-out="foo"/\>

Надрукує \-  3

якщо атрибута немає t-value, тіло вузла відображається і встановлюється як значення змінної:

\<t t-set="foo"\>

\<li\>ok\</li\>

\</t\>

\<t t-out="foo"/\>

Ще приклади:

\<t t-set="title"\>Company Data\</t\>

\<t t-set="record"   
   t-value="object.env\['crm.team'\].search(  
      \[('alias\_name', '\!=', 'False')\], limit=1)" /\>

### **Вирази**

Атрибути об’єктів {{ obj.name }} моделі в шаблоні визначаються контекстним словником, що передається шаблону.

Ви можете використовувати змінні моделі в шаблонах за умови, що вони передані програмою. Змінні можуть мати атрибути або елементи, до яких ви також можете отримати доступ. Які атрибути має змінна, значною мірою залежить від програми, яка надає цю змінну.

\<field name="partner\_to"\>  
    {{ object.partner\_id \!= False and object.partner\_id.id }}  
\</field\>

\<img t-attf-src="/logo.png?company={{ object.company\_id.id }}"   
     style="padding: 0px; margin: 0px; height: 48px;"   
     t-att-alt="object.company\_id.name"/\>

\<field name="lang"\>{{ object.partner\_id.lang }}\</field\>

Дата і час

\<field name="date\_open" eval="(DateTime.today() \-   
       relativedelta(months=1)).strftime('%Y-%m-%d %H:%M')"/\>

### **Атрибути**

QWeb може обчислювати атрибути та встановлювати їх у вихідному коді перегляду за допомогою спеціальних директив. Це дозволяє вам динамічно змінювати значення атрибутів залежно від умов. Існує декілька основних форм директиви t-att для роботи з атрибутами:

#### **t-att-$name**

створюється викликаний $name атрибут, оцінюється значення атрибута, а результат встановлюється як значення атрибута:

\<div t-att-a="42"/\>

буде відображатися як:

\<div a="42"\>\</div\>

приклад зі змінною:

\<div t-att-id="record.id"/\>

Якщо record.id \= 123, результат буде:

\<div id="123"\>\</div\>

#### **t-attf-$name**

Ця директива схожа на попередню, але дозволяє використовувати форматування рядків для поєднання тексту та змінних. Це зручно для створення складних атрибутів, таких як класи CSS:

\<t t-foreach="\[1, 2, 3\]" t-as="item"\>

   \<li t-attf-class="row {{ (item\_index % 2 \=== 0\) ?   
  'even' : 'odd' }}"\>

       \<t t-out="item"/\>

   \</li\>

\</t\>

буде відображатися як:

\<li class="row even"\>1\</li\>

\<li class="row odd"\>2\</li\>

\<li class="row even"\>3\</li\>

#### **t-att=mapping**

Якщо параметр є відображенням, кожна пара (ключ, значення) генерує новий атрибут і його значення. Це зручно для встановлення декількох атрибутів одночасно:

\<div t-att="{'a': 1, 'b': 2}"/\>

буде відображатися як:

\<div a="1" b="2"\>\</div\>

ще приклад:

\<div t-att="{'data-id': record.id, 'data-name': record.name}"/\>

якщо record.id \= 123 і record.name \= 'Example', то результат буде:

\<div data-id="123" data-name="Example"\>\</div\>

#### **t-att=pair** 

якщо параметр є парою (кортеж або масив з 2 елементів), першим елементом пари є ім'я атрибута, а другим елементом є значення:

\<div t-att="\['a', 'b'\]"/\>

буде відображатися як:

\<div a="b"\>\</div\>

ще приклад:

\<div t-att="\['data-status', 'active'\]"/\>

результат буде:

\<div data-status="active"\>\</div\>

Додаткові Приклади Використання Атрибутів:

Динамічне Додавання **CSS** Класів:

\<div t-att-class="condition ? 'highlight' : 'normal'"/\>

Це додасть клас highlight, якщо умова (condition) виконується, і клас normal — якщо ні.

\<div t-att-style="'color: red;' if is\_error else ''"/\>

Додає стиль лише у випадку, якщо змінна is\_error має значення True.

Використання в Odoo:

У Odoo такі директиви часто використовуються в шаблонах **QWeb** для створення динамічних сторінок, звітів та інших компонентів. Використовуючи ці директиви, ви можете легко адаптувати вигляд елементів залежно від даних, з якими працює ваша система.

Ці приклади допоможуть зробити ваші **QWeb** шаблони більш гнучкими та адаптивними до різних ситуацій.

### **Корисна інформація**

- [Офіційна документація Odoo найменування](https://www.odoo.com/documentation/17.0/contributing/development/coding_guidelines.html)  
- [Офіційна документація OCA найменування](https://github.com/OCA/odoo-community.org/blob/master/website/Contribution/CONTRIBUTING.rst)  
- [Офіційна документація Odoo створення модуля](https://www.odoo.com/documentation/17.0/developer/tutorials/server_framework_101/05_firstui.html)  
- [Офіційна документація Odoo QWeb Template](https://www.odoo.com/documentation/17.0/developer/reference/frontend/qweb.html#template-inheritance)  
- [Офіційна документація Odoo звіти](https://www.odoo.com/documentation/17.0/developer/reference/backend/reports.html)

  